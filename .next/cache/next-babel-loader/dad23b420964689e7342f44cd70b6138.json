{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { PureComponent } from 'react';\nimport Link from 'next/link';\nimport { StarOutlined, HeartFilled, HeartOutlined } from '@ant-design/icons';\nimport { TickIcon } from 'src/icons';\nimport { dobToAge, shortenLargeNumber } from '@lib/index';\nimport { connect } from 'react-redux';\nimport { message, Tooltip } from 'antd';\nimport Router from 'next/router';\nimport { followService } from 'src/services';\nimport './performer.less';\n\nclass PerformerGridCard extends PureComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      isFollowed: false,\n      requesting: false\n    });\n\n    _defineProperty(this, \"handleFollow\", async () => {\n      const {\n        performer,\n        user\n      } = this.props;\n      const {\n        isFollowed,\n        requesting\n      } = this.state;\n\n      if (!user._id) {\n        message.error('Please log in or register!');\n        return;\n      }\n\n      if (requesting || user.isPerformer) return;\n\n      try {\n        this.setState({\n          requesting: true\n        });\n\n        if (!isFollowed) {\n          await followService.create(performer === null || performer === void 0 ? void 0 : performer._id);\n          this.setState({\n            isFollowed: true,\n            requesting: false\n          });\n        } else {\n          await followService.delete(performer === null || performer === void 0 ? void 0 : performer._id);\n          this.setState({\n            isFollowed: false,\n            requesting: false\n          });\n        }\n      } catch (e) {\n        const error = await e;\n        message.error(error.message || 'Error occured, please try again later');\n        this.setState({\n          requesting: false\n        });\n      }\n    });\n\n    _defineProperty(this, \"handleJoinStream\", e => {\n      e.preventDefault();\n      const {\n        user,\n        performer\n      } = this.props;\n\n      if (!user._id) {\n        message.error('Please log in or register!');\n        return;\n      }\n\n      if (user.isPerformer) return;\n\n      if (!(performer !== null && performer !== void 0 && performer.isSubscribed)) {\n        message.error('Please subscribe to this model!');\n        return;\n      }\n\n      Router.push({\n        pathname: '/streaming/details',\n        query: {\n          performer: JSON.stringify(performer),\n          username: (performer === null || performer === void 0 ? void 0 : performer.username) || (performer === null || performer === void 0 ? void 0 : performer._id)\n        }\n      }, `/streaming/${(performer === null || performer === void 0 ? void 0 : performer.username) || (performer === null || performer === void 0 ? void 0 : performer._id)}`);\n    });\n  }\n\n  componentDidMount() {\n    const {\n      performer\n    } = this.props;\n    this.setState({\n      isFollowed: !!(performer !== null && performer !== void 0 && performer.isFollowed)\n    });\n  }\n\n  render() {\n    const {\n      performer,\n      user,\n      countries\n    } = this.props;\n    const {\n      isFollowed\n    } = this.state;\n    const country = countries && countries.length && countries.find(c => c.code === performer.country);\n    return __jsx(\"div\", {\n      className: \"grid-card\",\n      style: {\n        backgroundImage: `url(${(performer === null || performer === void 0 ? void 0 : performer.avatar) || '/static/no-avatar.png'})`\n      }\n    }, __jsx(\"span\", {\n      className: (performer === null || performer === void 0 ? void 0 : performer.isOnline) > 0 ? 'online-status active' : 'online-status'\n    }), (performer === null || performer === void 0 ? void 0 : performer.live) > 0 && __jsx(\"div\", {\n      className: \"live-status\"\n    }, \"Live\"), !(user !== null && user !== void 0 && user.isPerformer) && __jsx(\"a\", {\n      \"aria-hidden\": true,\n      onClick: () => this.handleFollow(),\n      className: !isFollowed ? 'follow-btn' : 'follow-btn active'\n    }, isFollowed ? __jsx(Tooltip, {\n      title: \"Following\"\n    }, __jsx(HeartFilled, null)) : __jsx(Tooltip, {\n      title: \"Follow\"\n    }, __jsx(HeartOutlined, null))), __jsx(\"div\", {\n      className: \"card-stat\"\n    }, __jsx(\"span\", null, shortenLargeNumber((performer === null || performer === void 0 ? void 0 : performer.score) || 0), ' ', __jsx(StarOutlined, null)), (performer === null || performer === void 0 ? void 0 : performer.dateOfBirth) && __jsx(\"span\", null, dobToAge(performer === null || performer === void 0 ? void 0 : performer.dateOfBirth))), __jsx(Link, {\n      href: {\n        pathname: '/model/profile',\n        query: {\n          username: (performer === null || performer === void 0 ? void 0 : performer.username) || (performer === null || performer === void 0 ? void 0 : performer._id)\n        }\n      },\n      as: `/${(performer === null || performer === void 0 ? void 0 : performer.username) || (performer === null || performer === void 0 ? void 0 : performer._id)}`\n    }, __jsx(\"a\", null, __jsx(\"div\", {\n      className: \"model-name\"\n    }, country && __jsx(\"img\", {\n      alt: \"performer-country\",\n      className: \"model-country\",\n      src: country === null || country === void 0 ? void 0 : country.flag\n    }), (performer === null || performer === void 0 ? void 0 : performer.name) || (performer === null || performer === void 0 ? void 0 : performer.username) || 'N/A', (performer === null || performer === void 0 ? void 0 : performer.verifiedAccount) && __jsx(TickIcon, null)))));\n  }\n\n}\n\nconst maptStateToProps = state => ({\n  user: _objectSpread({}, state.user.current)\n});\n\nexport default connect(maptStateToProps)(PerformerGridCard);","map":{"version":3,"sources":["c:/Users/Admin/Desktop/Work/foodiefans/foodiefans-main/user/src/components/performer/grid-card.tsx"],"names":["PureComponent","Link","StarOutlined","HeartFilled","HeartOutlined","TickIcon","dobToAge","shortenLargeNumber","connect","message","Tooltip","Router","followService","PerformerGridCard","isFollowed","requesting","performer","user","props","state","_id","error","isPerformer","setState","create","delete","e","preventDefault","isSubscribed","push","pathname","query","JSON","stringify","username","componentDidMount","render","countries","country","length","find","c","code","backgroundImage","avatar","isOnline","live","handleFollow","score","dateOfBirth","flag","name","verifiedAccount","maptStateToProps","current"],"mappings":"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","sourcesContent":["import { PureComponent } from 'react';\nimport { ICountry, IPerformer, IUser } from 'src/interfaces';\nimport Link from 'next/link';\nimport { StarOutlined, HeartFilled, HeartOutlined } from '@ant-design/icons';\nimport { TickIcon } from 'src/icons';\nimport { dobToAge, shortenLargeNumber } from '@lib/index';\nimport { connect } from 'react-redux';\nimport { message, Tooltip } from 'antd';\nimport Router from 'next/router';\nimport { followService } from 'src/services';\nimport './performer.less';\n\ninterface IProps {\n  performer: IPerformer;\n  user: IUser;\n  countries: ICountry[];\n}\n\nclass PerformerGridCard extends PureComponent<IProps> {\n  state = {\n    isFollowed: false,\n    requesting: false\n  }\n\n  componentDidMount(): void {\n    const { performer } = this.props;\n    this.setState({ isFollowed: !!performer?.isFollowed });\n  }\n\n  handleFollow = async () => {\n    const { performer, user } = this.props;\n    const { isFollowed, requesting } = this.state;\n    if (!user._id) {\n      message.error('Please log in or register!');\n      return;\n    }\n    if (requesting || user.isPerformer) return;\n    try {\n      this.setState({ requesting: true });\n      if (!isFollowed) {\n        await followService.create(performer?._id);\n        this.setState({ isFollowed: true, requesting: false });\n      } else {\n        await followService.delete(performer?._id);\n        this.setState({ isFollowed: false, requesting: false });\n      }\n    } catch (e) {\n      const error = await e;\n      message.error(error.message || 'Error occured, please try again later');\n      this.setState({ requesting: false });\n    }\n  }\n\n  handleJoinStream = (e) => {\n    e.preventDefault();\n    const { user, performer } = this.props;\n    if (!user._id) {\n      message.error('Please log in or register!');\n      return;\n    }\n    if (user.isPerformer) return;\n    if (!performer?.isSubscribed) {\n      message.error('Please subscribe to this model!');\n      return;\n    }\n    Router.push({\n      pathname: '/streaming/details',\n      query: {\n        performer: JSON.stringify(performer),\n        username: performer?.username || performer?._id\n      }\n    }, `/streaming/${performer?.username || performer?._id}`);\n  }\n\n  render() {\n    const { performer, user, countries } = this.props;\n    const { isFollowed } = this.state;\n    const country = countries && countries.length && countries.find((c) => c.code === performer.country);\n\n    return (\n      <div className=\"grid-card\" style={{ backgroundImage: `url(${performer?.avatar || '/static/no-avatar.png'})` }}>\n        {/* {performer?.isFreeSubscription && <span className=\"free-status\">Free</span>} */}\n        <span className={performer?.isOnline > 0 ? 'online-status active' : 'online-status'} />\n        {performer?.live > 0 && <div className=\"live-status\">Live</div>}\n        {!user?.isPerformer && (\n        <a aria-hidden onClick={() => this.handleFollow()} className={!isFollowed ? 'follow-btn' : 'follow-btn active'}>\n          {isFollowed ? <Tooltip title=\"Following\"><HeartFilled /></Tooltip> : <Tooltip title=\"Follow\"><HeartOutlined /></Tooltip>}\n        </a>\n        )}\n        <div className=\"card-stat\">\n          <span>\n            {shortenLargeNumber(performer?.score || 0)}\n            {' '}\n            <StarOutlined />\n          </span>\n          {performer?.dateOfBirth && (\n          <span>\n            {dobToAge(performer?.dateOfBirth)}\n          </span>\n          )}\n        </div>\n        <Link\n          href={{\n            pathname: '/model/profile',\n            query: { username: performer?.username || performer?._id }\n          }}\n          as={`/${performer?.username || performer?._id}`}\n        >\n          <a>\n            <div className=\"model-name\">\n              {country && (\n              <img alt=\"performer-country\" className=\"model-country\" src={country?.flag} />\n              )}\n              {performer?.name || performer?.username || 'N/A'}\n              {performer?.verifiedAccount && <TickIcon />}\n            </div>\n\n          </a>\n        </Link>\n      </div>\n    );\n  }\n}\n\nconst maptStateToProps = (state) => ({ user: { ...state.user.current } });\nexport default connect(maptStateToProps)(PerformerGridCard);\n"]},"metadata":{},"sourceType":"module"}